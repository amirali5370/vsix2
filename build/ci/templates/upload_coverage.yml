steps:
    # Generate the coverage reports.
    - bash: |
        npm run test:cover:report
      displayName: 'run test:cover:report'
      condition: contains(variables['TestsToRun'], 'testUnitTests')
      failOnStderr: false


    # Publish Code Coverage Results
    - task: PublishCodeCoverageResults@1
      displayName: 'Publish test:unittests coverage results'
      condition: contains(variables['TestsToRun'], 'testUnitTests')
      inputs:
        codeCoverageTool: 'cobertura'
        summaryFileLocation: "$(System.DefaultWorkingDirectory)/coverage/cobertura-coverage.xml"
        reportDirectory: "$(System.DefaultWorkingDirectory)/coverage"

    # - task: CopyFiles@2
    #   inputs:
    #       sourceFolder: "$(Build.SourcesDirectory)/VSIX"
    #       targetFolder: $(Build.SourcesDirectory)
    #   displayName: "Copy VSIX"
    #   condition: succeeded()

    - bash: |
        echo "Publish Coverage"
        ls
        echo "List folders"
        ls -dlU .*/ */
      displayName: "List nyc_output"
      condition: always()

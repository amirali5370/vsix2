jobs:
  - job: 'Static_Analysis'
    pool:
      vmImage: 'windows-latest'

    steps:
      - task: APIScan@2
        inputs:
          softwareFolder: '$(Build.SourcesDirectory)/src'
          softwareName: 'ms-python.python'
          softwareVersionNum: '$(Build.SourceBranchName)'
          softwareBuildNum: '$(Build.BuildId)'
          symbolsFolder: 'SRV*http://symweb'
        continueOnError: true

      - task: PoliCheck@1
        inputs:
          inputType: 'Basic'
          targetType: 'F'
          targetArgument: '$(Build.SourcesDirectory)'
          result: 'PoliCheck.xml'
        continueOnError: true

      - task: AntiMalware@3
        inputs:
          InputType: 'Basic'
          ScanType: 'CustomScan'
          FileDirPath: '$(Build.SourcesDirectory)'
          EnableServices: true
          SupportLogOnError: false
          TreatSignatureUpdateFailureAs: 'Warning'
          SignatureFreshness: 'UpToDate'
          TreatStaleSignatureAs: 'Error'
        continueOnError: true

      - task: AutoApplicability@1
        inputs:
          ExternalRelease: true
          IsSoftware: true

      - task: VulnerabilityAssessment@0
